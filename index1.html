<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raqamli Poytaxt</title>
    <link rel="stylesheet" href="offline_modules/bootstrap-5.3.6-dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="offline_modules/fontawesome-free-6.7.2-web/css/all.min.css">
    <script src="offline_modules/yandex-map" type="text/javascript"></script>
    <script src="offline_modules/bootstrap-5.3.6-dist/js/bootstrap.bundle.min.js"></script>
    <script src="offline_modules/chart.js"></script>
    <script src="js/data2.js"></script>
    <script src="js/other.js"></script>
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #1e40af;
            --accent-color: #f59e0b;
            --success-color: #10b981;
            --danger-color: #ef4444;
            --warning-color: #f59e0b;
            --dark-bg: #0f172a;
            --card-bg: #1e293b;
            --sidebar-bg: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border-color: #475569;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--dark-bg) 0%, #1a202c 100%);
            color: var(--text-primary);
            overflow-x: hidden;
        }
        footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            /* height: 20px; */
            /* background-color: #333; */
            color: white;
            text-align: end;
            font-size: 22px;
            /* line-height: 60px; */
        }
        footer .d-flex{
            background-color: #333;
            width: max-content;
            margin-left: auto;
            color: white;
        }
        /* Header Styles */
        .header {
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-color);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
        }

        .logo {
            height: 50px;
            filter: brightness(1.2);
        }

        .header-title {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(45deg, var(--primary-color), var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid var(--primary-color);
        }

        /* Main Layout */
        .main-container {
            display: flex;
            margin-top: 70px;
            min-height: calc(100vh - 70px);
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: var(--sidebar-bg);
            border-right: 1px solid var(--border-color);
            overflow-y: auto;
            transition: all 0.3s ease;
            position: relative;
        }

        .sidebar.collapsed {
            width: 80px;
        }

        .sidebar-toggle {
            position: absolute;
            top: 20px;
            right: -15px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            z-index: 10;
            transition: all 0.3s ease;
        }

        .sidebar-toggle:hover {
            background: var(--secondary-color);
            transform: scale(1.1);
        }

        .nav-item {
            margin: 0.5rem 1rem;
            padding: 1rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid transparent;
            position: relative;
            z-index: 100;
            /* overflow: hidden; */
        }

        .nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s;
        }

        .nav-item:hover::before {
            left: 100%;
        }

        .nav-item:hover {
            background: rgba(37, 99, 235, 0.1);
            border-color: var(--primary-color);
            transform: translateX(5px);
        }

        .nav-item.active {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            box-shadow: 0 8px 32px rgba(37, 99, 235, 0.3);
        }

        .nav-item-icon {
            display: inline-block;
            width: 20px;
            margin-right: 1rem;
            text-align: center;
            color: var(--accent-color);
        }

        .nav-item-text {
            font-weight: 500;
            transition: opacity 0.3s ease;
        }

        .sidebar.collapsed .nav-item-text {
            opacity: 0;
        }

        .sidebar.collapsed .nav-item {
            margin: 0.5rem 0.25rem;
            padding: 0.75rem;
            text-align: center;
        }

        /* Content Area */
        .content-area {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
            background: rgba(15, 23, 42, 0.5);
        }

        /* Card Styles */
        .dashboard-card {
            background: var(--card-bg);
            border-radius: 16px;
            border: 1px solid var(--border-color);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            overflow: hidden;
            position: relative;
        }

        .dashboard-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
        }

        .card-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
            background: rgba(30, 41, 59, 0.5);
        }
        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        .card-body {
            padding: .5rem;
            height: calc(100vh - 200px);
            overflow-y: auto;
            position: relative;
        }
        .districts {
            position: absolute;
            top: 1rem;
            left: 1rem;
            z-index: 100;
            background-color: var(--card-bg);
            padding: 10px;
            border-radius: 5px;
            overflow: hidden;
        }
        .statistics {
            position: absolute;
            top: 1rem;
            right: 1rem;
            z-index: 100;
            background-color: var(--card-bg);
            padding: 10px;
            border-radius: 5px;
            overflow: hidden;
            min-width: 350px;
            max-width: 350px;
            min-height: 650px;
        }
        .districts li{
            padding: 5px 10px;
            border-radius: 5px;
            background-color: var(--border-color);
            margin: 5px 0;
        }
        .districts li:hover{
            transform: translateX(-5px);
            cursor: pointer;

        }

        /* Map Styles */
        #Tmap {
            width: 100%;
            height: 100%;
            border-radius: 12px;
            position: relative;
            border-radius: 5px;
            overflow: hidden;
        }

        .map-overlay {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .overlay-card {
            margin-top: 55px;
            background: rgba(30, 41, 59, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 12px;
            padding: 0.3rem;
            border: 1px solid var(--border-color);
            min-width: 200px;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(to bottom, var(--primary-color), var(--accent-color));
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent-color);
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .stat-trend {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        /* Progress Circles */
        .progress-wrapper {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .circle {
            position: relative;
            width: 60px;
            height: 60px;
        }

        .circle svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .circle-bg {
            fill: none;
            stroke: var(--border-color);
            stroke-width: 4;
        }

        .circle-bar {
            fill: none;
            stroke: var(--primary-color);
            stroke-width: 4;
            stroke-linecap: round;
            transition: stroke-dashoffset 1s ease;
        }

        .circle-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: 600;
            font-size: 0.9rem;
        }

        /* Animations */
        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .sidebar {
            animation: slideInLeft 0.5s ease;
        }

        .content-area {
            animation: slideInRight 0.5s ease;
        }

        .dashboard-card {
            animation: fadeInUp 0.6s ease;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                left: -280px;
                z-index: 1001;
                height: 100vh;
            }

            .sidebar.open {
                left: 0;
            }

            .content-area {
                margin-left: 0;
                padding: 1rem;
            }

            .header {
                padding: 0 1rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Chart Styles */
        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 1rem;
        }

        /* List Styles */
        .custom-list {
            list-style: none;
            padding: 0;
        }

        .list-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .list-item:hover {
            background: rgba(37, 99, 235, 0.1);
            border-color: var(--primary-color);
        }

        /* Utility Classes */
        .text-gradient {
            background: linear-gradient(45deg, var(--primary-color), var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .glass-effect {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .platform-card {
        padding: 1.5rem;
        border-radius: 12px;
        color: white;
        text-align: center;
        transition: all 0.3s ease;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }

    .platform-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0,0,0,0.2);
    }

    .platform-icon {
        width: 60px;
        height: 60px;
        margin-bottom: 1rem;
        border-radius: 50%;
        object-fit: cover;
        border: 3px solid rgba(255,255,255,0.2);
    }

    .alert {
        background: rgba(245, 158, 11, 0.1);
        border-left: 4px solid var(--accent-color);
    }

    .badge {
        font-weight: 500;
        padding: 0.35em 0.65em;
    }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="d-flex align-items-center">
            <a href="index.html"><img src="./stat-crm/images/iib_logo.png" class="logo" alt="Logo"></a>
            <button class="btn btn-link text-light d-md-none ms-2" id="sidebarToggleMobile">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        <h1 class="header-title">Рақамли Пойтахт</h1>
        <div class="user-info">
            <i class="fas fa-language fs-5"></i>
            <img src="./m24-admin/images/avatar.jpg" alt="User" class="avatar">
            <span class="d-none d-md-inline">Тоштемиров Б.</span>
        </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <button class="sidebar-toggle" id="sidebarToggle">
                <i class="fas fa-chevron-left"></i>
            </button>
            
            <div class="p-3">
                <div class="nav-item active" data-card="mapCard">
                    <i class="nav-item-icon fas fa-map-marker-alt"></i>
                    <span class="nav-item-text">Рақамли хавфсиз маҳалла</span>
                </div>
                
                <div class="nav-item" data-card="crime">
                    <i class="nav-item-icon fas fa-exclamation-triangle"></i>
                    <span class="nav-item-text" data-bs-toggle="dropdown" aria-expanded="false">Жиноятчилик</span>
                </div>
                
                <div class="nav-item" data-card="demographic">
                    <i class="nav-item-icon fas fa-users"></i>
                    <span class="nav-item-text">Демографик маълумотлар</span>
                </div>
                
                <div class="nav-item" data-card="monitoring">
                    <i class="nav-item-icon fas fa-chart-line"></i>
                    <span class="nav-item-text">Хавф мониторинги</span>
                </div>
                
                <div class="nav-item" data-card="personal">
                    <i class="nav-item-icon fas fa-user-shield"></i>
                    <span class="nav-item-text">Шахсий назорат</span>
                </div>
                
                <div class="nav-item" data-card="maHuq">
                    <i class="nav-item-icon fas fa-gavel"></i>
                    <span class="nav-item-text">Маъмурий ҳуқуқбузарликлар</span>
                </div>
                
                <div class="nav-item" data-card="e-ma-mo">
                    <i class="nav-item-icon fas fa-envelope"></i>
                    <span class="nav-item-text">E-материал мониторинги</span>
                </div>
                
                <div class="nav-item" data-card="prophylactic">
                    <i class="nav-item-icon fas fa-shield-alt"></i>
                    <span class="nav-item-text">Профилактик тадбирлар</span>
                </div>
                
                <div class="nav-item" data-card="statistic">
                    <i class="nav-item-icon fas fa-th-large"></i>
                    <span class="nav-item-text">Таркибий платформалар</span>
                </div>
            </div>
        </aside>

        <!-- Content Area -->
        <main class="content-area">
            <!-- Map Card -->
            <div class="dashboard-card" id="mapCard">
                <div class="card-header">
                    <h2 class="card-title">Рақамли хавфсиз маҳалла</h2>
                </div>
                <div class="card-body">
                    <div id="Tmap" style="height: 100%; border-radius: 12px;"></div>
                    
                  <script>
                    ymaps.ready(init);
            
                    function init() {
                        var map = new ymaps.Map("Tmap", {
                            center: [41.311649232954316, 69.24125933467975], // Toshkent markazi
                            zoom: 12,
                            controls: ['zoomControl', 'typeSelector', 'fullscreenControl']
                        });

                         var mirobodCoordinates = [
                            [41.312697240084375, 69.26901837914095],
                            [41.305010925533516, 69.26554798348963],
                            [41.30456583881327, 69.26542369422948],
                            [41.3037736708225, 69.2654388670942],
                            [41.30271363241355, 69.26585612087365],
                            [41.30120407907706, 69.26705949283362],
                            [41.29979939401375, 69.26763689061126],
                            [41.29979400590848, 69.26764529083748],
                            [41.29572292382547, 69.26873131358758],
                            [41.292549490781504, 69.27121869513802],
                            [41.29063219663235, 69.2690114213818],
                            [41.28954890054428, 69.26896038615163],
                            [41.28880112814945, 69.26755691732205],
                            [41.28763151815846, 69.26628103652654],
                            [41.287458950987556, 69.26555378449666],
                            [41.28568531750194, 69.26616620725866],
                            [41.284774514003814, 69.26423962731988],
                            [41.284028411025396, 69.26505928299743],
                            [41.28326449798294, 69.26553722823571],
                            [41.28359514800942, 69.26636414936227],
                            [41.28011183680799, 69.2690497465342],
                            [41.2778484400206, 69.27297951864895],
                            [41.2715310382408, 69.2673579719591],
                            [41.269780530892106, 69.2656055060854],
                            [41.26817253164325, 69.26363303367341],
                            [41.267592608214, 69.2623709863034],
                            [41.26730749529848, 69.26270858254314],
                            [41.26708225521493, 69.26340653431967],
                            [41.26717064065679, 69.26410448609622],
                            [41.2680801484248, 69.26639558876052],
                            [41.2685990468676, 69.26854254922664],
                            [41.27014461830773, 69.27742177950338],
                            [41.271426762356384, 69.2828183837723],
                            [41.27066026397842, 69.2865943949216],
                            [41.2653379293872, 69.29311752733246],
                            [41.26443470228793, 69.29734468852918],
                            [41.263208874098495, 69.29734468852918],
                            [41.26285402477284, 69.30094957759923],
                            [41.261966893094886, 69.30266619128318],
                            [41.264644381092126, 69.30813789740075],
                            [41.260934579197254, 69.31079864902595],
                            [41.257208435570334, 69.30202246127686],
                            [41.252643216631185, 69.30221558030456],
                            [41.25254230092032, 69.30164197718175],
                            [41.24427947371576, 69.30162868776581],
                            [41.24424524801555, 69.31188554484181],
                            [41.2436462953993, 69.3141235424853],
                            [41.24210040185822, 69.31664223814636],
                            [41.237445387156335, 69.32253689631675],
                            [41.23693765101891, 69.32650460064956],
                            [41.23810263427187, 69.33077662047191],
                            [41.27782612941688, 69.30818658868588],
                            [41.279609564746444, 69.30619621470939],
                            [41.2825626730758, 69.30583896809823],
                            [41.291567317704505, 69.29963602484807],
                            [41.29959275853903, 69.29155245665495],
                            [41.30029764872079, 69.2903976612204],
                            [41.302629154276175, 69.28823241978058],
                            [41.30990779540875, 69.28079842375675],
                            [41.31009754426568, 69.27892188117559],
                            [41.31281825127222, 69.2691388820126],
                            [41.30928848664218, 69.26733643764446],
                            [41.305049292993175, 69.26557690861841],
                        ];

                        var mirobodPolygon = new ymaps.Polygon([mirobodCoordinates], {
                                balloonContent: `
                                    <div style="padding: 5px;">
                                        <b>Mirobod Tumani</b><br>
                                        <small>Hudud: ~28.58 km²</small><br>
                                        <a href="#" onclick="alert('More info about Mirobod!'); return false;">Batafsil</a>
                                    </div>
                                `,
                                hintContent: "Mirobod Tumani"
                            }, {
                                fillColor: '#000080',
                                strokeColor: '#800000',
                                strokeWidth: 3,
                                fillOpacity: .5
                            });

                        map.geoObjects.add(mirobodPolygon);                     
                        
                        // Kameralar joylashuvi - updated to be near district centers
                        var cameras = [
                            [41.2855, 69.2203], // Near Mirzo Ulugbek
                            [41.3359, 69.2807], // Near Yunusobod
                            [41.3151, 69.2755], // Near Shaykhontokhur
                            // [41.2958, 69.1457], // Near Almazar
                            [41.3523, 69.2604], // Near Yashnobod
                            [41.3025, 69.2401]  // Central area
                        ];
                        
                        cameras.forEach(function(camera) {
                            var cameraPlacemark = new ymaps.Placemark(camera, {}, {
                                preset: 'islands#videoCameraIcon',
                                iconColor: '#2563eb'
                            });
                            map.geoObjects.add(cameraPlacemark);
                        });

                        var polygonCoordinates = [
                            [41.235785707706064, 69.16466935839502],
                            [41.23648484378027, 69.16532598148007],
                            [41.23699258341695, 69.16554598801811],
                            [41.23802801774724, 69.16559150660542],
                            [41.23843591161046, 69.16565978449661],
                            [41.238886588603805, 69.16596703503888],
                            [41.239348671893545, 69.16647532600658],
                            [41.239819308943005, 69.16672188507223],
                            [41.24018725916911, 69.16680154261195],
                            [41.24070923151752, 69.16673326472076],
                            [41.24113707462253, 69.16673326472073],
                            [41.24162481231518, 69.16666119361336],
                            [41.24542069297069, 69.16537129416822],
                            [41.249445967780495, 69.16398727428711],
                            [41.25102696977063, 69.1629358484057],
                            [41.25236595181777, 69.1614874555194],
                            [41.253946883145396, 69.15893399266454],
                            [41.25695538661568, 69.1540201857498],
                            [41.259721797016105, 69.15026509309581],
                            [41.26110899080131, 69.14873086942322],
                            [41.26350425014009, 69.14747559566683],
                            [41.2649155571902, 69.14706789984737],
                            [41.26818967187177, 69.14696061149212],
                            [41.273769804333014, 69.14660655990804],
                            [41.27768851401504, 69.1465421868847],
                            [41.28348551507881, 69.14848410622487],
                            [41.28694412027792, 69.14935314200771],
                            [41.292248571033014, 69.1500397875503],
                            [41.29844729902818, 69.1507693484179],
                            [41.30354126129522, 69.15135943439154],
                            [41.304597080292, 69.15069424653284],
                            [41.307079396433416, 69.1510268404341],
                            [41.30852199786677, 69.15206753759772],
                            [41.31117339978456, 69.15274345423578],
                            [41.3128259127436, 69.1533967314782],
                            [41.30987639683839, 69.14796257608991],
                            [41.3099674477869, 69.1474976566908],
                            [41.3101583487167, 69.14724540778363],
                            [41.31034497520485, 69.14715816381155],
                            [41.31061565389478, 69.14718661293287],
                            [41.31097038374992, 69.14732885854822],
                            [41.31121541689311, 69.14748627701955],
                            [41.31145617531498, 69.14777076823194],
                            [41.311676988461706, 69.14775749197533],
                            [41.31174964294645, 69.14763990227384],
                            [41.31178810705266, 69.14751662274809],
                            [41.31184509087198, 69.14737058392528],
                            [41.312192691102595, 69.14733834158588],
                            [41.31307592924276, 69.14695901995087],
                            [41.313614413719876, 69.1464886611298],
                            [41.31373692543759, 69.14666694229011],
                            [41.31372552900845, 69.14688315561219],
                            [41.31364290483757, 69.14701591817838],
                            [41.31323548067051, 69.14718661290634],
                            [41.31313861021412, 69.14736489406665],
                            [41.3132012911141, 69.1475545548755],
                            [41.31329103866143, 69.14763041919903],
                            [41.313437768512316, 69.14758869382108],
                            [41.31357737524828, 69.14742368891739],
                            [41.31370273614417, 69.14738386014753],
                            [41.31380387941856, 69.14745024143063],
                            [41.3138067285226, 69.14744644821445],
                            [41.313822398592634, 69.14757731417255],
                            [41.31370416069843, 69.14799836116819],
                            [41.31376541650173, 69.14816336607188],
                            [41.31390502254509, 69.14822216094288],
                            [41.31440076401488, 69.14822785077006],
                            [41.314705614650386, 69.14835113029581],
                            [41.315335254918736, 69.14910218714431],
                            [41.31547343308314, 69.14956495954655],
                            [41.31563725216771, 69.14967875603186],
                            [41.316054632856435, 69.14973186106653],
                            [41.31869845660948, 69.1514862236405],
                            [41.31901040933691, 69.15175554198906],
                            [41.31953887380718, 69.1519148570891],
                            [41.32000750852172, 69.15220883136537],
                            [41.320306635302934, 69.15251228868055],
                            [41.32044195410663, 69.15278919346147],
                            [41.32042201240583, 69.15324627601079],
                            [41.32056587739615, 69.15348714523802],
                            [41.320587243456735, 69.15379060253217],
                            [41.320481837489886, 69.15402198871895],
                            [41.320551633351855, 69.15428941045943],
                            [41.32071259088206, 69.15435389520522],
                            [41.320799479289164, 69.1542590648008],
                            [41.32087497240128, 69.15400491931695],
                            [41.320920553105886, 69.15369766880661],
                            [41.321021685180376, 69.15356680284852],
                            [41.321129939058046, 69.15356490624042],
                            [41.3212524366576, 69.1537071518551],
                            [41.32141196806022, 69.15405423113528],
                            [41.32154016265434, 69.15419458013382],
                            [41.32214124951369, 69.15432734270345],
                            [41.32238054321917, 69.1545245899593],
                            [41.32251016026976, 69.1545056238784],
                            [41.322686780890734, 69.15436148166368],
                            [41.32337382138504, 69.15352341094446],
                            [41.32357626074237, 69.15351134100577],
                            [41.32400228777984, 69.15378626742609],
                            [41.32433162592283, 69.15389288523605],
                            [41.32461463382407, 69.15390227297165],
                            [41.325012454236074, 69.1536340520723],
                            [41.325153453291044, 69.15344093303288],
                            [41.32525013818095, 69.15346775512168],
                            [41.32536092277427, 69.15363941649008],
                            [41.32541732213126, 69.15397737480912],
                            [41.32581815903176, 69.15441725709076],
                            [41.32595714209812, 69.15465060926341],
                            [41.32609209638606, 69.15464256263677],
                            [41.32639221760662, 69.15441993929964],
                            [41.32658759780445, 69.15445212582188],
                            [41.327282501978104, 69.15493224123537],
                            [41.327415439320944, 69.15516291119916],
                            [41.32741141092058, 69.15542576766951],
                            [41.33099930770814, 69.15596804323215],
                            [41.33186938848176, 69.15890774416592],
                            [41.32135714872845, 69.1569577783093],
                            [41.335176114857624, 69.16345140601604],
                            [41.33748810045237, 69.16417023842412],
                            [41.34761823312181, 69.16507741691082],
                            [41.35146810937243, 69.16607882608515],
                            [41.35436106178949, 69.16732300114327],
                            [41.35721971911079, 69.16950789366115],
                            [41.36065905284953, 69.17361974025933],
                            [41.39787649893043, 69.23256631964776],
                            [41.39859254828139, 69.2377138971002],
                            [41.39770881119321, 69.25870163433737],
                            [41.39675273839119, 69.26225208467892],
                            [41.394112083306126, 69.26677359836172],
                            [41.38400375677169, 69.2851631132556],
                            [41.38373053695672, 69.29608757584496],
                            [41.38474803018706, 69.30870241374059],
                            [41.38478022900689, 69.31501096902909],
                            [41.38362106144854, 69.318015042976],
                            [41.38281607160671, 69.3187875199725],
                            [41.37695544677317, 69.32140535584051],
                            [41.37019253110642, 69.32453817581373],
                            [41.35608475851734, 69.34350675797342],
                            [41.35612502470267, 69.34639281588272],
                            [41.355891480052705, 69.3477661068299],
                            [41.354900919292014, 69.3511671476912],
                            [41.35497339985885, 69.3536455086974],
                            [41.35532774815197, 69.35522264793994],
                            [41.35610891821919, 69.35670322724235],
                            [41.35701892925883, 69.35775465312375],
                            [41.36195531615206, 69.36188525488689],
                            [41.36254314803729, 69.36294740960385],
                            [41.362768616392565, 69.36405247966287],
                            [41.36276861642081, 69.36553305940441],
                            [41.36149632046715, 69.37513536747126],
                            [41.36620691210505, 69.3904829674201],
                            [41.36644041977044, 69.39430243317938],
                            [41.36460051792014, 69.40351313898941],
                            [41.35520694779226, 69.41110915492376],
                            [41.34956540262505, 69.41227939227906],
                            [41.346603401581696, 69.41148705452034],
                            [41.34369568835397, 69.40934665177375],
                            [41.34181889588669, 69.40711505385244],
                            [41.33770749987126, 69.39800461291283],
                            [41.337244305351255, 69.39563890442709],
                            [41.33712347146519, 69.39405640118721],
                            [41.33842568243215, 69.38563902951732],
                            [41.33764430015553, 69.38141723243099],
                            [41.33735430023336, 69.38076813788174],
                            [41.336999854130546, 69.38014586542133],
                            [41.33624664975767, 69.37945921994775],
                            [41.33550552037598, 69.37908907512214],
                            [41.33501814260533, 69.3788530407074],
                            [41.3336284918884, 69.37790890318124],
                            [41.33095383427374, 69.37562366111493],
                            [41.33032543488392, 69.37494774434127],
                            [41.314980136673526, 69.3530287321377],
                            [41.31377943326297, 69.35085077852621],
                            [41.31321936600974, 69.35027142124893],
                            [41.312054894324476, 69.35015340405815],
                            [41.30997571663996, 69.34986372549977],
                            [41.308851482485196, 69.34931655485991],
                            [41.30785617655605, 69.34859235843527],
                            [41.30771514007857, 69.3485869940175],
                            [41.30760231067695, 69.34861381610631],
                            [41.30747739218313, 69.34866746028392],
                            [41.30735247344995, 69.34873719771484],
                            [41.30727591023713, 69.34893031675428],
                            [41.30541821736155, 69.35973961854535],
                            [41.305097850594265, 69.36022466694692],
                            [41.30472912470435, 69.36030781542223],
                            [41.304428903724, 69.36032927309328],
                            [41.303071538368705, 69.36060793335784],
                            [41.30224244933921, 69.36118845910099],
                            [41.301830297113156, 69.36185191709315],
                            [41.30166255999632, 69.36264296316072],
                            [41.30167214499658, 69.36335745666679],
                            [41.302103468076226, 69.3670511314501],
                            [41.30202199615151, 69.36870977665951],
                            [41.30179195724331, 69.3695199609384],
                            [41.30137021713745, 69.37055342434927],
                            [41.30071843157347, 69.37091067100592],
                            [41.29971198524228, 69.37179102872629],
                            [41.29911769535362, 69.36981341355734],
                            [41.298590498129975, 69.36870339721528],
                            [41.297699045937705, 69.36674492025764],
                            [41.29266642595783, 69.37123602057049],
                            [41.292263799589094, 69.37031738642749],
                            [41.29168621813758, 69.37090429157439],
                            [41.29034803318072, 69.37088057604322],
                            [41.28960699541881, 69.36906741871067],
                            [41.28974950329716, 69.3672390882525],
                            [41.289578493761105, 69.36657148220537],
                            [41.28958989441078, 69.3661238826965],
                            [41.287532044869984, 69.36008508254295],
                            [41.272052260602436, 69.36259036363357],
                            [41.27012500470334, 69.36391040286313],
                            [41.2683915661852, 69.36620150543395],
                            [41.268517013938556, 69.36676290142812],
                            [41.26831173567122, 69.3673242974223],
                            [41.267798537179246, 69.36765810044587],
                            [41.26814066995542, 69.36944849848135],
                            [41.27019342898236, 69.37439485293429],
                            [41.27278209415629, 69.37738390728164],
                            [41.27388823255344, 69.37926534250536],
                            [41.27407068657073, 69.3801453686584],
                            [41.27372858486997, 69.38113160486438],
                            [41.26948637483286, 69.38163230939973],
                            [41.26639577397103, 69.38316476899016],
                            [41.265677273869684, 69.3842420423844],
                            [41.26543777207899, 69.38639658917286],
                            [41.265859750871165, 69.39023532440379],
                            [41.2659711869282, 69.39571272841029],
                            [41.26561763794833, 69.39721484201634],
                            [41.264864914389186, 69.39748795358108],
                            [41.262971662231784, 69.39539409825144],
                            [41.25412055050454, 69.38401445001442],
                            [41.248112496159145, 69.3917601979328],
                            [41.24679487116393, 69.3926781562476],
                            [41.24585939832877, 69.39313334218883],
                            [41.24511785542284, 69.3933533487263],
                            [41.24511215121438, 69.3933533487263],
                            [41.24421658430905, 69.393368521591],
                            [41.243355231311405, 69.39308023716156],
                            [41.242493866960196, 69.39242021754679],
                            [41.24195764760717, 69.39178295705464],
                            [41.23911104802721, 69.38725385678026],
                            [41.24295022026684, 69.38291441747391],
                            [41.24231132463093, 69.38018330182656],
                            [41.24420517565263, 69.37463003334364],
                            [41.24452461499363, 69.37226306644929],
                            [41.24415954133358, 69.36971402517842],
                            [41.24283613221853, 69.36622426629572],
                            [41.239504673327424, 69.36064065134656],
                            [41.23747376921907, 69.35693847235794],
                            [41.23117528317946, 69.35141554910506],
                            [41.2284594443976, 69.34558916905739],
                            [41.22318719990103, 69.33372398796504],
                            [41.219124314511184, 69.32364920449366],
                            [41.20974219383034, 69.29779464186569],
                            [41.20419446768675, 69.27940512984027],
                            [41.191955844704864, 69.2564334110558],
                            [41.188598956680096, 69.26031766457369],
                            [41.18674916944321, 69.26137976510321],
                            [41.182958084162365, 69.25764724038518],
                            [41.1711723452077, 69.24866490418486],
                            [41.16623815022512, 69.24578205936245],
                            [41.16621530586382, 69.2375280205047],
                            [41.1669234772655, 69.23337065557486],
                            [41.170395690790514, 69.22229446433842],
                            [41.1740961369303, 69.210307900354],
                            [41.17706547958292, 69.20381391396724],
                            [41.182364279593116, 69.19862479423729],
                            [41.1924125505498, 69.18949072900713],
                            [41.19636292582258, 69.18657753844921],
                            [41.19999340708355, 69.18502990624904],
                            [41.20318989064202, 69.18554578367936],
                            [41.20857745083762, 69.18848931947501],
                            [41.21382804522278, 69.19301083315781],
                            [41.22241071834284, 69.19992965984567],
                            [41.22473880241157, 69.20014207995158],
                            [41.22706680359816, 69.19765373013955],
                            [41.227454795737906, 69.19373913104504],
                            [41.226039754468076, 69.18809482537385],
                            [41.227454795737906, 69.18196498803205],
                            [41.228915451500285, 69.17680621330688],
                            [41.229554478082605, 69.17395371474187],
                            [41.234118772032204, 69.16976600408262],
                            [41.23500877222371, 69.1685218291766],
                            [41.23548514555255, 69.16653797711609],
                            [41.23573331472042, 69.1657110559075],
                            [41.235720478407615, 69.1651193141839],
                            [41.235785707706064, 69.16466935839502]
                        ]

                        var myPolygon = new ymaps.Polygon([polygonCoordinates], {}, {
                            strokeColor: '#008000',
                            strokeWidth: 3,
                            fillOpacity: 0
                        });
                       
                        map.geoObjects.add(myPolygon);

                        const validLocationRegex = /^-?\d+(\.\d+)?, ?-?\d+(\.\d+)?$/;

                        const crimeMarkers = data2.filter(item => validLocationRegex.test(item["Содир этилган жиноятнинг локацияси"]))
                        .map(item => {
                            const coords = item["Содир этилган жиноятнинг локацияси"]
                            .split(',').map(coord => parseFloat(coord.trim()));
                            return {
                            coords: coords,
                            title: `Жиноят: ${item["Ҳужжат id"]}`,
                            color: "red"
                            };
                        });

                        var clusterer = new ymaps.Clusterer({
                            preset: 'islands#invertedRedClusterIcons', // markerlar guruhi uchun dizayn
                            groupByCoordinates: false,
                            clusterDisableClickZoom: false,
                            clusterOpenBalloonOnClick: false
                        });

                        // Har bir marker uchun Placemark yaratish
                        var placemarks = crimeMarkers.map(function (point) {
                            var placemark = new ymaps.Placemark(point.coords, {
                                hintContent: point.title,
                                balloonContent: point.title
                            }, {
                                preset: point.color === "red" ? 'islands#redIcon' : 'islands#blueIcon'
                            });

                            // 🔍 Markerga klik qilinganda fokuslash
                            placemark.events.add('click', function () {
                                map.setCenter(point.coords, 20, {
                                    checkZoomRange: true
                                });
                            });

                            return placemark;
                        });

                        // Markerlarni klasterga qo‘shish
                        clusterer.add(placemarks);
                        map.geoObjects.add(clusterer);
                    }
                
                </script>

                    <!-- Map Overlays -->
                    <!-- <div class="map-overlay">
                        <div class="overlay-card">
                            <h6 class="text-gradient mb-2">Камералар</h6>
                            <div class="d-flex align-items-center gap-2 mb-2">
                                <i class="fas fa-video text-primary"></i>
                                <span>Видеокузатув: <strong>806</strong></span>
                            </div>
                            <div class="d-flex align-items-center gap-2 mb-2">
                                <i class="fas fa-user-check text-success"></i>
                                <span>FaceID: <strong>3509</strong></span>
                            </div>
                            <div class="d-flex align-items-center gap-2">
                                <i class="fas fa-camera text-warning"></i>
                                <span>PTZ: <strong>51</strong></span>
                            </div>
                        </div>
            
                        <div class="overlay-card">
                            <h6 class="text-gradient mb-2">Хавфсизлик кўрсатгичи</h6>
                            <div class="progress-wrapper">
                                <div class="circle">
                                    <svg>
                                        <circle class="circle-bg" cx="30" cy="30" r="25" />
                                        <circle class="circle-bar" cx="30" cy="30" r="25" 
                                                style="stroke-dasharray: 157; stroke-dashoffset: 15.7;" />
                                    </svg>
                                    <div class="circle-text">95%</div>
                                </div>
                                <div>
                                    <div class="fw-bold">Умумий хавфсизлик</div>
                                    <small class="text-success">+2.5% бугунги кунда</small>
                                </div>
                            </div>
                        </div>
                    </div> -->
                </div>
            </div>

            <!-- Crime Card -->
            <div class="dashboard-card d-none" id="crime">
                <div class="card-header">
                    <h2 class="card-title">Жиноятчилик</h2>
                </div>
                <div class="card-body">
                    <script src="js/data.js"></script>
                    <div id="map" style="height: 100%; border-radius: 12px;"></div>
                    
                    <div class="districts">
                        <h5>Туманлар рўйҳати</h5>
                        <ul class="list-unstyled" id="districts">
                            <li data-district="olmazor">Олмазор тумани</li>
                            <li data-district="shayhontohur">Шайхонтоҳур тумани</li>
                            <li>Бектемир тумани</li>
                            <li data-district="chilonzor">Чилонзор тумани</li>
                            <li data-district="mirobod">Миробод тумани</li>
                            <li>Мирзо Улуғбек тумани</li>
                            <li>Сергели тумани</li>
                            <li>Учтепа тумани</li>
                            <li>Яккасарой тумани</li>
                            <li>Янгиҳаёт тумани</li>
                            <li>Яшнобод тумани</li>
                            <li>Юнусобод тумани</li>
                        </ul>
                    </div>

                    <div class="statistics">
                        <h5>Туман бўйича динамика</h5>
                        <div class="chart-container">
                            <canvas id="birthRegionChart"></canvas>
                            <canvas id="ageGroupChart" class="mt-5"></canvas>
                        </div>
                    </div>
                  <script>
                    function filterByDistrict(other, districtName) {
                        return other.filter(item => 
                            item["Туман"].toLowerCase().includes(districtName.toLowerCase())
                        );
                    }
                    // 1. Filter for "Олмазор тумани"
                    const olmazorResults = filterByDistrict(other, "Миробод");
                    // console.log("Миробод туманидаги жиноятлар:", olmazorResults);

                   // Group data by birth region and count
                    const regionCounts = olmazorResults.reduce((acc, item) => {
                        const region = item["Тўғилган вилоят"];
                        if (region !== undefined){
                            acc[region] = (acc[region] || 0) + 1;
                        }
                        return acc;
                    }, {});

                    // Prepare data for Chart.js
                    const regions = Object.keys(regionCounts);
                    const counts = Object.values(regionCounts);

                    // Generate colors dynamically
                    const borderColors = regions.map((_, i) => {
                        const hue = (i * 360 / regions.length) % 360;
                        return `hsl(${hue}, 70%, 50%)`;
                    });

                    // Create line chart
                    const ctx = document.getElementById('birthRegionChart').getContext('2d');
                    new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: regions,
                            datasets: [{
                                // label: 'Тўғилган вилоят буйича динамика',
                                data: counts,
                                backgroundColor: 'rgba(54, 162, 235, 0.2)',
                                borderColor: borderColors,
                                borderWidth: 3,
                                pointBackgroundColor: borderColors,
                                pointRadius: 5,
                                pointHoverRadius: 7,
                                tension: 0.3,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: {
                                    display: false,
                                    position: 'top',
                                },
                                title: {
                                    display: true,
                                    text: 'Вилоят буйича динамика',
                                    font: {
                                        size: 18
                                    },
                                    color: 'white'
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            return `${context.parsed.y} нафар`;
                                        }
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        // text: 'Сон'
                                    },
                                    ticks: {
                                        color: 'white',
                                        stepSize: 1
                                    }
                                },
                                x: {
                                    ticks: {
                                        color: 'white'
                                    }
                                }
                            },
                            animation: {
                                duration: 2000
                            }
                        }
                    });
                    
                    // Group data by age category
                    const ageGroups = {};
                    olmazorResults.forEach(item => {
                        const ageGroup = item[" Ёш тоифаси"];
                        if (!ageGroups[ageGroup]) {
                            ageGroups[ageGroup] = 0;
                        }
                        ageGroups[ageGroup]++;
                    });

                    // Sort age groups logically
                    const sortedAgeGroups = {
                        "15-17 ёш": ageGroups["15-17 ёш"] || 0,
                        "18-30 ёш": ageGroups["18-30 ёш"] || 0,
                        "31-49 ёш": ageGroups["31-49 ёш"] || 0,
                        "50-59 ёш": ageGroups["50-59 ёш"] || 0,
                        "60 ёш ва ундан катта": ageGroups["60 ёш ва ундан катта"] || 0
                    };

                    // Prepare chart data
                    const labels = Object.keys(sortedAgeGroups);
                    const data1 = Object.values(sortedAgeGroups);

                    // Create bar chart
                    const ctx1 = document.getElementById('ageGroupChart').getContext('2d');
                    new Chart(ctx1, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Сон',
                                data: data1,
                                backgroundColor: [
                                    'rgba(54, 162, 235, 0.7)',
                                    'rgba(255, 99, 132, 0.7)',
                                    'rgba(75, 192, 192, 0.7)',
                                    'rgba(153, 102, 255, 0.7)'
                                ],
                                borderColor: [
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 99, 132, 1)',
                                    'rgba(75, 192, 192, 1)',
                                    'rgba(153, 102, 255, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: {
                                    display: false
                                },
                                title: {
                                    display: true,
                                    text: 'Ёш гуруҳлари буйича динамика',
                                    font: {
                                        size: 16
                                    },
                                    color: 'white'
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            return `${context.parsed.y} нафар`;
                                        }
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        // text: 'Сон'
                                    },
                                    ticks: {
                                        precision: 0,
                                        color: 'white'
                                    }
                                },
                                x: {
                                    // title: {
                                    //     display: true,
                                    //     text: 'Ёш тоифаси'
                                    // },
                                    ticks: {
                                        color: 'white'
                                    }
                                }
                            }
                        }
                    });
                    // *****************************************************************
                    ymaps.ready(init);
            
                    function init() {
                        var map = new ymaps.Map("map", {
                            center: [41.311649232954316, 69.24125933467975], // Toshkent markazi
                            zoom: 12,
                            controls: ['zoomControl', 'typeSelector', 'fullscreenControl']
                        });

                        var districts = {
                            mirobod: createDistrictPolygon(
                                [[41.312697240084375, 69.26901837914095],
                                [41.305010925533516, 69.26554798348963],
                                [41.30456583881327, 69.26542369422948],
                                [41.3037736708225, 69.2654388670942],
                                [41.30271363241355, 69.26585612087365],
                                [41.30120407907706, 69.26705949283362],
                                [41.29979939401375, 69.26763689061126],
                                [41.29979400590848, 69.26764529083748],
                                [41.29572292382547, 69.26873131358758],
                                [41.292549490781504, 69.27121869513802],
                                [41.29063219663235, 69.2690114213818],
                                [41.28954890054428, 69.26896038615163],
                                [41.28880112814945, 69.26755691732205],
                                [41.28763151815846, 69.26628103652654],
                                [41.287458950987556, 69.26555378449666],
                                [41.28568531750194, 69.26616620725866],
                                [41.284774514003814, 69.26423962731988],
                                [41.284028411025396, 69.26505928299743],
                                [41.28326449798294, 69.26553722823571],
                                [41.28359514800942, 69.26636414936227],
                                [41.28011183680799, 69.2690497465342],
                                [41.2778484400206, 69.27297951864895],
                                [41.2715310382408, 69.2673579719591],
                                [41.269780530892106, 69.2656055060854],
                                [41.26817253164325, 69.26363303367341],
                                [41.267592608214, 69.2623709863034],
                                [41.26730749529848, 69.26270858254314],
                                [41.26708225521493, 69.26340653431967],
                                [41.26717064065679, 69.26410448609622],
                                [41.2680801484248, 69.26639558876052],
                                [41.2685990468676, 69.26854254922664],
                                [41.27014461830773, 69.27742177950338],
                                [41.271426762356384, 69.2828183837723],
                                [41.27066026397842, 69.2865943949216],
                                [41.2653379293872, 69.29311752733246],
                                [41.26443470228793, 69.29734468852918],
                                [41.263208874098495, 69.29734468852918],
                                [41.26285402477284, 69.30094957759923],
                                [41.261966893094886, 69.30266619128318],
                                [41.264644381092126, 69.30813789740075],
                                [41.260934579197254, 69.31079864902595],
                                [41.257208435570334, 69.30202246127686],
                                [41.252643216631185, 69.30221558030456],
                                [41.25254230092032, 69.30164197718175],
                                [41.24427947371576, 69.30162868776581],
                                [41.24424524801555, 69.31188554484181],
                                [41.2436462953993, 69.3141235424853],
                                [41.24210040185822, 69.31664223814636],
                                [41.237445387156335, 69.32253689631675],
                                [41.23693765101891, 69.32650460064956],
                                [41.23810263427187, 69.33077662047191],
                                [41.27782612941688, 69.30818658868588],
                                [41.279609564746444, 69.30619621470939],
                                [41.2825626730758, 69.30583896809823],
                                [41.291567317704505, 69.29963602484807],
                                [41.29959275853903, 69.29155245665495],
                                [41.30029764872079, 69.2903976612204],
                                [41.302629154276175, 69.28823241978058],
                                [41.30990779540875, 69.28079842375675],
                                [41.31009754426568, 69.27892188117559],
                                [41.31281825127222, 69.2691388820126],
                                [41.30928848664218, 69.26733643764446],
                                [41.305049292993175, 69.26557690861841]],
                                "Mirobod tumani", "~28.58 km²"
                            ),
                            chilonzor: createDistrictPolygon(
                                [[41.22828451770735, 69.17974875085794],
                                [41.229220520389866, 69.17529091969745],
                                [41.22966027564416, 69.17376206063518],
                                [41.23037840171874, 69.17276427893138],
                                [41.23420289541749, 69.16956708572467],
                                [41.2347596068482, 69.1689769997708],
                                [41.23519529079133, 69.16803286210023],
                                [41.23576006189457, 69.16577980664005],
                                [41.23576006190187, 69.16462109230015],
                                [41.23639744057159, 69.16528628010269],
                                [41.23703481302622, 69.16557595866185],
                                [41.23806750459672, 69.16564033167928],
                                [41.238680657480806, 69.16576907770558],
                                [41.23935834608159, 69.16648790968574],
                                [41.2399069460257, 69.16679904592077],
                                [41.24167897167312, 69.16671573743692],
                                [41.24899008459856, 69.16426327554163],
                                [41.25068583341618, 69.1631626110972],
                                [41.251879614132186, 69.16198977198398],
                                [41.25299198107476, 69.16049214665478],
                                [41.259285993460985, 69.15076660334589],
                                [41.26100860229474, 69.14899832283672],
                                [41.26336926275403, 69.1555604137001],
                                [41.26421605234161, 69.15785102008462],
                                [41.26487734708744, 69.15913848058729],
                                [41.266405557434105, 69.16194407116129],
                                [41.26698618735296, 69.16262535225401],
                                [41.268582892985194, 69.16377333769182],
                                [41.26880062254248, 69.16412738926412],
                                [41.26780067339862, 69.16779665116046],
                                [41.26801840556441, 69.16799513461766],
                                [41.26802243763473, 69.16799513461766],
                                [41.269877163594735, 69.17112259030286],
                                [41.268861102869096, 69.17218474501979],
                                [41.270856921478774, 69.17538730262217],
                                [41.27123591852043, 69.17621342295757],
                                [41.271534276360086, 69.17735067968427],
                                [41.27281639313764, 69.18285993697978],
                                [41.274300069175666, 69.18918458581108],
                                [41.27533217175353, 69.19324545027818],
                                [41.2756466372802, 69.1943451560313],
                                [41.276041732816616, 69.19475821619899],
                                [41.27673112848472, 69.1959115660179],
                                [41.27784785343446, 69.19711319580294],
                                [41.278883931291716, 69.19801978240477],
                                [41.2810558313198, 69.19450572003159],
                                [41.29216057085208, 69.19405053411008],
                                [41.30292147162992, 69.19368638532073],
                                [41.30055057822702, 69.20112108902738],
                                [41.30068736289146, 69.21890368710748],
                                [41.3013940790368, 69.2209975424371],
                                [41.30200959976224, 69.22230240880195],
                                [41.30200959976224, 69.22369831235504],
                                [41.29954748200343, 69.23155785627348],
                                [41.31007922301885, 69.24020638970747],
                                [41.31169758669414, 69.24035811883263],
                                [41.31106506209144, 69.25998801375972],
                                [41.310355601502, 69.25962007179056],
                                [41.310147605568474, 69.25893729287873],
                                [41.30928141524495, 69.25843949809008],
                                [41.307576905497726, 69.25691063902781],
                                [41.30429267709042, 69.25371344587128],
                                [41.30334969012798, 69.25353642004823],
                                [41.30286610178761, 69.25285513893301],
                                [41.30224381988155, 69.25212565261283],
                                [41.30225340478353, 69.25147495337013],
                                [41.30165194930966, 69.25099649808733],
                                [41.30117269792767, 69.25013846819478],
                                [41.30079887942156, 69.24912414299523],
                                [41.300103954691224, 69.24828525130633],
                                [41.29725718124607, 69.24207171189504],
                                [41.29507161919173, 69.24166343005372],
                                [41.29488948571497, 69.24056617260513],
                                [41.29383501874932, 69.24011961434118],
                                [41.29297226026907, 69.2388947687236],
                                [41.2917356200291, 69.23769544081469],
                                [41.28966491411592, 69.23800165219569],
                                [41.287038090669725, 69.23676404780944],
                                [41.28636698744881, 69.23507988521395],
                                [41.28534543538795, 69.23500942139523],
                                [41.28511174238037, 69.23523907993098],
                                [41.284898580778375, 69.23517718144356],
                                [41.28441544175085, 69.23486993092249],
                                [41.28381115663907, 69.23493251898623],
                                [41.282041025132926, 69.23469923617769],
                                [41.28137400659504, 69.23464044132363],
                                [41.28111603392923, 69.23452285162216],
                                [41.280158248013485, 69.23288797537246],
                                [41.2801140640968, 69.23203260507847],
                                [41.279464129502486, 69.2310406789988],
                                [41.27924178196721, 69.23007530542091],
                                [41.27848208885381, 69.22939631970048],
                                [41.277877748801, 69.22863388321704],
                                [41.2755201989824, 69.22600328767273],
                                [41.273233835941284, 69.22466428228117],
                                [41.27175136326917, 69.22328355151662],
                                [41.27021753880102, 69.22253249469472],
                                [41.269399294256715, 69.22162591598506],
                                [41.268874700046375, 69.2215045330674],
                                [41.26820469584959, 69.22115935035545],
                                [41.26670215083998, 69.22057519503944],
                                [41.265852499066625, 69.2196079248451],
                                [41.26527940557002, 69.21898204417592],
                                [41.26512543929586, 69.21923618965977],
                                [41.26441547898111, 69.21839030239262],
                                [41.26291854942557, 69.21847375314812],
                                [41.261772305886375, 69.21789718427392],
                                [41.26047206496376, 69.21662266356807],
                                [41.258997857008126, 69.21567435947827],
                                [41.2577317795156, 69.21528365818884],
                                [41.25628032263756, 69.21430880159373],
                                [41.255641557317375, 69.21393706640487],
                                [41.25403606158034, 69.21446432346397],
                                [41.25323564020067, 69.2153870971996],
                                [41.23636562314215, 69.18855516076857],
                                [41.228289206149164, 69.17985260992957],
                                ],
                                "Chilonzor tumani", "29.94 km2"
                            ),
                            shayhontohur: createDistrictPolygon(
                                [[41.32509184676999, 69.23168666639012],
                                [41.34079149731064, 69.20477000385301],
                                [41.34514298030099, 69.20677282204734],
                                [41.348126886211915, 69.19775332297732],
                                [41.3501315682135, 69.18843718382001],
                                [41.35002219089141, 69.1870747718457],
                                [41.34933878237147, 69.17857796760953],
                                [41.3482908753948, 69.17269089553716],
                                [41.34826809462061, 69.16540792047759],
                                [41.338471622919485, 69.16413339970447],
                                [41.334734906017204, 69.16331406501027],
                                [41.33159042936641, 69.1619485071866],
                                [41.33107635113889, 69.16357470564391],
                                [41.33108774453414, 69.16384023077629],
                                [41.33141815212896, 69.16465197903814],
                                [41.33147227045579, 69.1653461376755],
                                [41.33125010020079, 69.1661313334241],
                                [41.33128428028884, 69.16692411566123],
                                [41.33063485553515, 69.16939349945157],
                                [41.330432621067786, 69.16938211980305],
                                [41.33042493748999, 69.16952427670819],
                                [41.328203556178195, 69.16920900909376],
                                [41.32621754860767, 69.19415623538679],
                                [41.32369567490717, 69.1933569371402],
                                [41.3233572690922, 69.19307798741656],
                                [41.302953104338044, 69.19361236363018],
                                [41.30057623107364, 69.20102620645912],
                                [41.30081585938655, 69.21947544252176],
                                [41.301927723233895, 69.22238445064124],
                                [41.301946893134016, 69.22366033139541],
                                [41.29941641758798, 69.23164734513148],
                                [41.30990191534264, 69.2403998874104],
                                [41.3117419750092, 69.24045092264058],
                                [41.311090293210334, 69.25999741672055],
                                [41.312029479700804, 69.26045673379205],
                                [41.312316983103145, 69.26323815421783],
                                [41.31363948224431, 69.26428437643624],
                                [41.31712768465715, 69.26561129260634],
                                [41.318028453838096, 69.26645337390407],
                                [41.3220530152331, 69.26818857208723],
                                [41.322992043773134, 69.26931134715089],
                                [41.32491796820888, 69.26989825253952],
                                [41.32573239670959, 69.2706255045694],
                                [41.326355188106334, 69.27091895714285],
                                [41.326901323407455, 69.2709189572084],
                                [41.32830017527189, 69.27074033390282],
                                [41.32898042799606, 69.27111033932152],
                                [41.33013013481573, 69.27289657252237],
                                [41.33351207129803, 69.27285829609212],
                                [41.33740156021746, 69.27491246419739],
                                [41.344289026113664, 69.26303401419351],
                                [41.33783743684114, 69.2575477269833],
                                [41.33805297909723, 69.25691616600999],
                                [41.32866851047272, 69.2479977594207],
                                [41.33030945127967, 69.24498648014617],
                                [41.330742980087194, 69.24378077278328],
                                [41.33085794857538, 69.24292593259432],
                                [41.33083878717948, 69.24200091901025],
                                [41.33064956806187, 69.24110461272765],
                                [41.33036454075439, 69.24056874277098],
                                [41.329928614220115, 69.2400743389517],
                                [41.329727416365635, 69.23987976709432],
                                [41.32923399997972, 69.23953846899259],
                                [41.32851935622039, 69.23947897821782],
                                [41.328909594188104, 69.23879999252216],
                                [41.32911753025286, 69.23801858998972],
                                [41.329339707785174, 69.23589677958759],
                                [41.32514724568914, 69.23164110223428]],
                                "Shayhontohur tumani", "29.70 km2"
                            ),
                            olmazor: createDistrictPolygon(
                                [[41.263111, 69.154577],
                                [41.262172, 69.154942],
                                [41.260505, 69.155575],
                                [41.260246, 69.154480],
                                [41.260254, 69.154255],
                                [41.259485, 69.152818],
                                [41.260318, 69.151712],
                                [41.259412, 69.150414],
                                [41.260691, 69.149620],
                                [41.261492, 69.150071],
                                [41.262019, 69.151616],
                                [41.262440, 69.152818],
                                [41.262998, 69.154556]],
                                "Al Xorazmiy mahalla", "12.34"
                            )
                        
                        }

                        for (var key in districts) {
                            if (districts.hasOwnProperty(key)) {
                                map.geoObjects.add(districts[key].polygon);
                            }
                        }

                        // Ro'yxat elementlariga hodisa qo'shish
                        document.querySelectorAll('#districts li').forEach(function(item) {
                            item.addEventListener('click', function() {
                                // Faol elementni belgilash
                                document.querySelectorAll('#districts li').forEach(function(li) {
                                    li.classList.remove('active');
                                });
                                this.classList.add('active');
                                
                                // Tegishli tuman poligonini topish
                                var districtId = this.getAttribute('data-district');
                                var district = districts[districtId];
                                
                                if (district) {
                                    // Xaritani poligon markaziga va kattalashtirish
                                    map.setBounds(district.polygon.geometry.getBounds(), {
                                        checkZoomRange: true
                                    });
                                    
                                    // Poligon stilini o'zgartirish (tanlanganini ajratib ko'rsatish)
                                    for (var key in districts) {
                                        if (districts.hasOwnProperty(key)) {
                                            districts[key].polygon.options.set({
                                                fillColor: '#000080',
                                                fillOpacity: 0.2
                                            });
                                        }
                                    }
                                    district.polygon.options.set({
                                        fillColor: '#FF0000',
                                        fillOpacity: 0.5
                                    });
                                    
                                    // Balloon ochish
                                    district.polygon.balloon.open();
                                }
                            });
                        });
                        
                        // Poligon yaratish uchun yordamchi funksiya
                        function createDistrictPolygon(coordinates, name, area) {
                            var polygon = new ymaps.Polygon([coordinates], {
                                balloonContent: `
                                    <div style="padding: 5px;">
                                        <b>${name}</b><br>
                                        <small>Hudud: ${area}</small>                                        
                                    </div>
                                `,
                                hintContent: name
                            }, {
                                fillColor: '#000080',
                                strokeColor: '#800000',
                                strokeWidth: 3,
                                fillOpacity: 0.2
                            });
                            
                            return {
                                polygon: polygon,
                                name: name,
                                area: area
                            };
                        }

                        var polygonCoordinates = [
                            [41.397959470975074, 69.23403486321702],
                            [41.357255685865226, 69.16811689682896],
                            [41.333027425069545, 69.1626237329633],
                            [41.310744371279036, 69.15180162417637],
                            [41.28006679416332, 69.14726476493163],
                            [41.266001416392456, 69.14669765752605],
                            [41.24894841080359, 69.16257666488261],
                            [41.229758457888266, 69.17335170558883],
                            [41.227199371794676, 69.18469385370067],
                            [41.22762589309935, 69.19887153884045],
                            [41.23189095311937, 69.20567682770755],
                            [41.24169953525792, 69.21361633138581],
                            [41.244980557233994, 69.27014669867877], // 41.244980557233994, 69.27014669867877
                            [41.24340522537849, 69.31456144958106],
                            [41.23786156971283, 69.32136673844816],
                            [41.23786156971283, 69.32760491990967],
                            [41.248522028619945, 69.35255764575568], 
                            [41.26770647207268, 69.36503400867869],
                            [41.26813272903575, 69.36616822348988],
                            [41.290720365750985, 69.357661612406],
                            [41.30648445947063, 69.33951417542708],
                            [41.333743085290884, 69.37807747900729],
                            [41.33459473363532, 69.37807747900729],
                            [41.341407519542706, 69.37580904938494],
                            [41.35503095343275, 69.3440510346718],
                            [41.36950272840403, 69.32476938288171],
                            [41.36907713389997, 69.3259035976929],
                            [41.38524776780425, 69.31626277179784],
                            [41.38397128498231, 69.28337054227356],
                            [41.39716039908299, 69.26068624604989],
                            [41.397585809826694, 69.23516641279829]
                        ];

                        var myPolygon = new ymaps.Polygon([polygonCoordinates], {}, {
                            strokeColor: '#008000',
                            strokeWidth: 3,
                            fillOpacity: 0
                        });
                       
                        map.geoObjects.add(myPolygon);

                        const validLocationRegex = /^-?\d+(\.\d+)?, ?-?\d+(\.\d+)?$/;

                        const crimeMarkers = data2.filter(item => validLocationRegex.test(item["Содир этилган жиноятнинг локацияси"]))
                        .map(item => {
                            const coords = item["Содир этилган жиноятнинг локацияси"]
                            .split(',').map(coord => parseFloat(coord.trim()));
                            return {
                            coords: coords,
                            title: `Жиноят: ${item["Ҳужжат id"]}`,
                            color: "red"
                            };
                        });

                        var clusterer = new ymaps.Clusterer({
                            preset: 'islands#invertedRedClusterIcons', // markerlar guruhi uchun dizayn
                            groupByCoordinates: false,
                            clusterDisableClickZoom: false,
                            clusterOpenBalloonOnClick: false
                        });

                        // Har bir marker uchun Placemark yaratish
                        var placemarks = crimeMarkers.map(function (point) {
                            var placemark = new ymaps.Placemark(point.coords, {
                                hintContent: point.title,
                                balloonContent: point.title
                            }, {
                                preset: point.color === "red" ? 'islands#redIcon' : 'islands#blueIcon'
                            });

                            // 🔍 Markerga klik qilinganda fokuslash
                            placemark.events.add('click', function () {
                                map.setCenter(point.coords, 20, {
                                    checkZoomRange: true
                                });
                            });

                            return placemark;
                        });

                        // Markerlarni klasterga qo‘shish
                        clusterer.add(placemarks);
                        map.geoObjects.add(clusterer);
                    }
                
                </script>
                </div>
            </div>

            <!-- Other Cards (Hidden by Default) -->
            <div class="dashboard-card d-none" id="demographic">
                <div class="card-header">
                    <h2 class="card-title">Демографик маълумотлар</h2>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="chart-container">
                                <canvas id="populationChart"></canvas>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-value">2,694,400</div>
                                    <div class="stat-label">Аҳоли сони</div>
                                    <div class="stat-trend">
                                        <i class="fas fa-arrow-up text-success"></i>
                                        <span class="badge bg-success">+1.8%</span>
                                    </div>
                                </div>
                                
                                <div class="stat-card">
                                    <div class="stat-value">1.29M</div>
                                    <div class="stat-label">Эркаклар</div>
                                    <div class="stat-trend">
                                        <i class="fas fa-mars text-primary"></i>
                                        <span>48%</span>
                                    </div>
                                </div>
                                
                                <div class="stat-card">
                                    <div class="stat-value">1.40M</div>
                                    <div class="stat-label">Аёллар</div>
                                    <div class="stat-trend">
                                        <i class="fas fa-venus text-danger"></i>
                                        <span>52%</span>
                                    </div>
                                </div>
                                
                                <div class="stat-card">
                                    <div class="stat-value">23.5</div>
                                    <div class="stat-label">Ўртача ёш</div>
                                    <div class="stat-trend">
                                        <i class="fas fa-user-clock text-warning"></i>
                                        <span>+0.3 йил</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-4">
                                <h5>Туманлар бўйича аҳоли</h5>
                                <ul class="custom-list">
                                    <li class="list-item">
                                        <div>Мирзо Улуғбек</div>
                                        <strong>365,200</strong>
                                    </li>
                                    <li class="list-item">
                                        <div>Юнусобод</div>
                                        <strong>341,800</strong>
                                    </li>
                                    <li class="list-item">
                                        <div>Шайхонтохур</div>
                                        <strong>298,500</strong>
                                    </li>
                                    <li class="list-item">
                                        <div>Олмазор</div>
                                        <strong>276,300</strong>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            // Population Chart
                            const popCtx = document.getElementById('populationChart').getContext('2d');
                            const popChart = new Chart(popCtx, {
                                type: 'bar',
                                data: {
                                    labels: ['0-14', '15-24', '25-54', '55-64', '65+'],
                                    datasets: [{
                                        label: 'Эркаклар',
                                        data: [320000, 280000, 450000, 150000, 90000],
                                        backgroundColor: 'rgba(37, 99, 235, 0.7)',
                                        borderColor: 'rgba(37, 99, 235, 1)',
                                        borderWidth: 1
                                    }, {
                                        label: 'Аёллар',
                                        data: [310000, 290000, 470000, 170000, 120000],
                                        backgroundColor: 'rgba(239, 68, 68, 0.7)',
                                        borderColor: 'rgba(239, 68, 68, 1)',
                                        borderWidth: 1
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    plugins: {
                                        title: {
                                            display: true,
                                            text: 'Ёш гуруҳлари бўйича аҳоли тақсимоти',
                                            color: '#f1f5f9'
                                        },
                                        legend: {
                                            labels: {
                                                color: '#f1f5f9'
                                            }
                                        }
                                    },
                                    scales: {
                                        x: {
                                            ticks: {
                                                color: '#94a3b8'
                                            },
                                            grid: {
                                                color: 'rgba(148, 163, 184, 0.1)'
                                            }
                                        },
                                        y: {
                                            ticks: {
                                                color: '#94a3b8'
                                            },
                                            grid: {
                                                color: 'rgba(148, 163, 184, 0.1)'
                                            }
                                        }
                                    }
                                }
                            });
                        });
                    </script>
                </div>
            </div>

            <div class="dashboard-card d-none" id="monitoring">
    <div class="card-header">
        <h2 class="card-title">Хавф мониторинги</h2>
    </div>
    <div class="card-body">
        <div class="stats-grid mb-4">
            <div class="stat-card">
                <div class="stat-value">1,475</div>
                <div class="stat-label">Жами жиноятлар миқдори</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">17:00-19:00</div>
                <div class="stat-label">Энг хавфли вақт</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">05:10-06:00</div>
                <div class="stat-label">Энг хавфсиз вақт</div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-4">
                <div class="chart-container" style="height: 200px;">
                    <canvas id="timeChart"></canvas>
                </div>
                <h6 class="text-center mt-2">Вақт бўйича таҳлил</h6>
            </div>
            <div class="col-md-4">
                <div class="chart-container" style="height: 200px;">
                    <canvas id="districtChart"></canvas>
                </div>
                <h6 class="text-center mt-2">Туманлар бўйича</h6>
            </div>
            <div class="col-md-4">
                <div class="chart-container" style="height: 200px;">
                    <canvas id="typeChart"></canvas>
                </div>
                <h6 class="text-center mt-2">Жиноят турлари</h6>
            </div>
        </div>
        
        <div class="mt-4">
            <h5>Охирги 7 кундаги жиноятлар</h5>
            <div class="table-responsive">
                <table class="table table-dark table-hover">
                    <thead>
                        <tr>
                            <th>Сана</th>
                            <th>Туман</th>
                            <th>Жиноят тури</th>
                            <th>Ҳолати</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>2023-11-20</td>
                            <td>Шайхонтохур</td>
                            <td>Уғрилик</td>
                            <td><span class="badge bg-success">Аникланган</span></td>
                        </tr>
                        <tr>
                            <td>2023-11-19</td>
                            <td>Мирзо Улуғбек</td>
                            <td>Қасаллик</td>
                            <td><span class="badge bg-warning">Терговда</span></td>
                        </tr>
                        <tr>
                            <td>2023-11-18</td>
                            <td>Юнусобод</td>
                            <td>Ноқонуний мол олиб қочиш</td>
                            <td><span class="badge bg-danger">Қидирувда</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                // Time Analysis Chart
                const timeCtx = document.getElementById('timeChart').getContext('2d');
                const timeChart = new Chart(timeCtx, {
                    type: 'line',
                    data: {
                        labels: ['00:00', '03:00', '06:00', '09:00', '12:00', '15:00', '18:00', '21:00'],
                        datasets: [{
                            label: 'Жиноятлар',
                            data: [12, 8, 5, 18, 22, 35, 42, 28],
                            borderColor: '#f59e0b',
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            tension: 0.3,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
                
                // District Chart
                const districtCtx = document.getElementById('districtChart').getContext('2d');
                const districtChart = new Chart(districtCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Шайхонтохур', 'Мирзо Улуғбек', 'Юнусобод', 'Олмазор', 'Яшнобод'],
                        datasets: [{
                            data: [31, 23, 18, 15, 12],
                            backgroundColor: [
                                '#ef4444',
                                '#f59e0b',
                                '#10b981',
                                '#3b82f6',
                                '#8b5cf6'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
                
                // Type Chart
                const typeCtx = document.getElementById('typeChart').getContext('2d');
                const typeChart = new Chart(typeCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Уғрилик', 'Қасаллик', 'Ноқонуний мол', 'Бошқалар'],
                        datasets: [{
                            label: 'Жиноятлар',
                            data: [45, 32, 28, 15],
                            backgroundColor: 'rgba(239, 68, 68, 0.7)'
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            });
        </script>
        </div>
            </div>

                    <!-- Personal Control Card -->
            <div class="dashboard-card d-none" id="personal">
                <div class="card-header">
                    <h2 class="card-title">Шахсий назорат</h2>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="stat-card mb-4">
                                <div class="stat-value">1,248</div>
                                <div class="stat-label">Назоратдаги шахслар</div>
                                <div class="stat-trend">
                                    <i class="fas fa-arrow-up text-warning"></i>
                                    <span class="badge bg-warning">+2.3%</span>
                                </div>
                            </div>
                            
                            <ul class="custom-list">
                                <li class="list-item">
                                    <div class="d-flex align-items-center">
                                        <i class="fas fa-user-clock text-primary me-2"></i>
                                        <span>Профилактикадаги шахслар</span>
                                    </div>
                                    <strong>892</strong>
                                </li>
                                <li class="list-item">
                                    <div class="d-flex align-items-center">
                                        <i class="fas fa-user-shield text-success me-2"></i>
                                        <span>Назоратдаги оилавий зўравонлик</span>
                                    </div>
                                    <strong>156</strong>
                                </li>
                                <li class="list-item">
                                    <div class="d-flex align-items-center">
                                        <i class="fas fa-user-graduate text-info me-2"></i>
                                        <span>Ижтимоий ишлардаги шахслар</span>
                                    </div>
                                    <strong>200</strong>
                                </li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <div class="chart-container">
                                <canvas id="personalChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Administrative Violations Card -->
            <div class="dashboard-card d-none" id="maHuq">
                <div class="card-header">
                    <h2 class="card-title">Маъмурий ҳуқуқбузарликлар</h2>
                </div>
                <div class="card-body">
                    <div class="stats-grid mb-4">
                        <div class="stat-card">
                            <div class="stat-value">1,128</div>
                            <div class="stat-label">Жами аниқланган ҳуқуқбузарликлар</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">221</div>
                            <div class="stat-label">Профилактика инспектори томонидан</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">147</div>
                            <div class="stat-label">Суд томонидан кўриб чиқилган</div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-4">
                            <h5 class="mb-3">Жарималар</h5>
                            <div class="progress-wrapper">
                                <div class="circle">
                                    <svg>
                                        <circle class="circle-bg" cx="30" cy="30" r="25" />
                                        <circle class="circle-bar" cx="30" cy="30" r="25" />
                                    </svg>
                                    <div class="circle-text">68%</div>
                                </div>
                                <div>
                                    <div class="fw-bold">Жарима солинган</div>
                                    <small class="text-secondary">767 та</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <h5 class="mb-3">Огоҳлантириш</h5>
                            <div class="progress-wrapper">
                                <div class="circle">
                                    <svg>
                                        <circle class="circle-bg" cx="30" cy="30" r="25" />
                                        <circle class="circle-bar" cx="30" cy="30" r="25" />
                                    </svg>
                                    <div class="circle-text">22%</div>
                                </div>
                                <div>
                                    <div class="fw-bold">Огоҳлантирилган</div>
                                    <small class="text-secondary">248 та</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <h5 class="mb-3">Маъмурий қамоқ</h5>
                            <div class="progress-wrapper">
                                <div class="circle">
                                    <svg>
                                        <circle class="circle-bg" cx="30" cy="30" r="25" />
                                        <circle class="circle-bar" cx="30" cy="30" r="25" />
                                    </svg>
                                    <div class="circle-text">10%</div>
                                </div>
                                <div>
                                    <div class="fw-bold">Қамоққа олинган</div>
                                    <small class="text-secondary">113 та</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- E-Material Monitoring Card -->
            <div class="dashboard-card d-none" id="e-ma-mo">
                <div class="card-header">
                    <h2 class="card-title">E-материал мониторинги</h2>
                </div>
                <div class="card-body">
                    <ul class="custom-list">
                        <li class="list-item">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-envelope bg-primary p-2 rounded-circle me-3"></i>
                                <div>
                                    <div class="fw-bold">Келиб тушган хабарлар</div>
                                    <small class="text-secondary">Охирги 24 соатда</small>
                                </div>
                            </div>
                            <div class="text-end">
                                <div class="fw-bold">203</div>
                                <small class="text-danger">
                                    <i class="fas fa-arrow-trend-up"></i> +127.9%
                                </small>
                            </div>
                        </li>
                        <li class="list-item">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-phone bg-success p-2 rounded-circle me-3"></i>
                                <div>
                                    <div class="fw-bold">Қўзғатилган ишлар</div>
                                    <small class="text-secondary">Охирги 7 кунда</small>
                                </div>
                            </div>
                            <div class="text-end">
                                <div class="fw-bold">156</div>
                                <small class="text-success">
                                    <i class="fas fa-arrow-trend-down"></i> -27.9%
                                </small>
                            </div>
                        </li>
                        <li class="list-item">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-file bg-info p-2 rounded-circle me-3"></i>
                                <div>
                                    <div class="fw-bold">Судга юборилган ҳужжатлар</div>
                                    <small class="text-secondary">Охирги 30 кунда</small>
                                </div>
                            </div>
                            <div class="fw-bold">87</div>
                        </li>
                        <li class="list-item">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-camera bg-warning p-2 rounded-circle me-3"></i>
                                <div>
                                    <div class="fw-bold">Жиноят ишини қўзғатишни рад этиш</div>
                                    <small class="text-secondary">Охирги 7 кунда</small>
                                </div>
                            </div>
                            <div class="fw-bold">23</div>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Prophylactic Measures Card -->
            <div class="dashboard-card d-none" id="prophylactic">
                <div class="card-header">
                    <h2 class="card-title">Профилактик тадбирлар</h2>
                </div>
                <div class="card-body">
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        <strong>17:00 - 19:00 оралиғида патрул кучайтириш</strong>
                        <p class="mb-0 mt-1">Бешқўрғон МФЙ ҳудудида доимий назорат</p>
                    </div>
                    
                    <h5 class="mt-4 mb-3">Яқиндаги тадбирлар</h5>
                    <ul class="custom-list">
                        <li class="list-item">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-calendar-check text-primary me-3"></i>
                                <div>
                                    <div class="fw-bold">Ижтимоий хавфсизлик машғулотлари</div>
                                    <small class="text-secondary">2023-11-15, 10:00</small>
                                </div>
                            </div>
                            <span class="badge bg-success">Бажарилди</span>
                        </li>
                        <li class="list-item">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-calendar-day text-info me-3"></i>
                                <div>
                                    <div class="fw-bold">Ёшлар билан ишлаш бўйича семинар</div>
                                    <small class="text-secondary">2023-11-20, 14:00</small>
                                </div>
                            </div>
                            <span class="badge bg-warning">Режалаштирилган</span>
                        </li>
                        <li class="list-item">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-calendar-alt text-success me-3"></i>
                                <div>
                                    <div class="fw-bold">Махалла хавфсизлиги кенгаши</div>
                                    <small class="text-secondary">2023-11-25, 09:30</small>
                                </div>
                            </div>
                            <span class="badge bg-primary">Яқинлашмокда</span>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Structural Platforms Card -->
            <div class="dashboard-card d-none" id="statistic">
                <div class="card-header">
                    <h2 class="card-title">Таркибий платформалар</h2>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4 mb-4">
                            <a href="m24-admin/index.html" class="text-decoration-none">
                                <div class="platform-card bg-primary">
                                    <img src="images/mahalla.png" alt="Mahalla 24" class="platform-icon">
                                    <h5>Маҳалла 24</h5>
                                    <p>Махаллабай ишлаш тизими</p>
                                </div>
                            </a>
                        </div>
                        <div class="col-md-4 mb-4">
                            <a href="prob24/dashboard.html" class="text-decoration-none">
                                <div class="platform-card bg-success">
                                    <img src="images/prob.png" alt="Digital Probation" class="platform-icon">
                                    <h5>Рақамли Пробация</h5>
                                    <p>Пробация хизмати тизими</p>
                                </div>
                            </a>
                        </div>
                        <div class="col-md-4 mb-4">
                            <a href="stat-crm/index.html" class="text-decoration-none">
                                <div class="platform-card bg-warning">
                                    <img src="images/Yoshlar.png" alt="Youth Work" class="platform-icon">
                                    <h5>Ёшлар билан ишлаш</h5>
                                    <p>Ёшлар ижтимоий хавфсизлиги</p>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- JavaScript for Interactive Functionality -->
            <script>
                // Initialize sidebar toggle functionality
                document.getElementById('sidebarToggle').addEventListener('click', function() {
                    const sidebar = document.getElementById('sidebar');
                    sidebar.classList.toggle('collapsed');
                    
                    // Change icon based on state
                    if (sidebar.classList.contains('collapsed')) {
                        this.innerHTML = '<i class="fas fa-chevron-right"></i>';
                    } else {
                        this.innerHTML = '<i class="fas fa-chevron-left"></i>';
                    }
                });

                // Mobile sidebar toggle
                document.getElementById('sidebarToggleMobile').addEventListener('click', function() {
                    document.getElementById('sidebar').classList.toggle('open');
                });

                // Card navigation from sidebar
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', function() {
                        // Remove active class from all nav items
                        document.querySelectorAll('.nav-item').forEach(nav => {
                            nav.classList.remove('active');
                        });
                        
                        // Add active class to clicked item
                        this.classList.add('active');
                        
                        // Hide all cards
                        document.querySelectorAll('.dashboard-card').forEach(card => {
                            card.classList.add('d-none');
                        });
                        
                        // Show selected card
                        const cardId = this.getAttribute('data-card');
                        document.getElementById(cardId).classList.remove('d-none');
                    });
                });

                // Initialize charts
                // document.addEventListener('DOMContentLoaded', function() {

                //     if (document.getElementById('Tmap')) {
                //     ymaps.ready(init);
                    
                //     function init() {
                //         var map = new ymaps.Map("Tmap", {
                //             center: [41.2995, 69.2401], // Toshkent markazi
                //             zoom: 11,
                //             controls: ['zoomControl', 'typeSelector', 'fullscreenControl']
                //         });
                        
                //         // Turli xil hududlar uchun belgilar
                //         var districts = [
                //             {coords: [41.2825, 69.2163], name: "Мирзо Улуғбек тумани", crime: 23},
                //             {coords: [41.3389, 69.2847], name: "Юнусобод тумани", crime: 18},
                //             {coords: [41.3111, 69.2795], name: "Шайхонтохур тумани", crime: 31},
                //             {coords: [41.2928, 69.1397], name: "Олмазор тумани", crime: 15},
                //             {coords: [41.3573, 69.2664], name: "Яшнобод тумани", crime: 12}
                //         ];
                        
                //         districts.forEach(function(district) {
                //             var color = district.crime > 25 ? '#ef4444' : 
                //                        district.crime > 15 ? '#f59e0b' : '#10b981';
                            
                //             var placemark = new ymaps.Placemark(district.coords, {
                //                 balloonContent: `<strong>${district.name}</strong><br>Жиноятлар: ${district.crime}`
                //             }, {
                //                 preset: 'islands#circleIcon',
                //                 iconColor: color
                //             });
                            
                //             map.geoObjects.add(placemark);
                //         });
                        
                //         // Kameralar joylashuvi
                //         var cameras = [
                //             [41.2925, 69.2263], [41.2989, 69.2447], [41.3011, 69.2595],
                //             [41.3228, 69.2397], [41.3173, 69.2164], [41.2875, 69.1963]
                //         ];
                        
                //         cameras.forEach(function(camera) {
                //             var cameraPlacemark = new ymaps.Placemark(camera, {}, {
                //                 preset: 'islands#videoCameraIcon',
                //                 iconColor: '#2563eb'
                //             });
                //             map.geoObjects.add(cameraPlacemark);
                //         });
                //     }
                // }
                    // Crime Chart
                    // const crimeCtx = document.getElementById('crimeChart').getContext('2d');
                    // const crimeChart = new Chart(crimeCtx, {
                    //     type: 'line',
                    //     data: {
                    //         labels: ['Янв', 'Фев', 'Мар', 'Апр', 'Май', 'Июн', 'Июл'],
                    //         datasets: [{
                    //             label: 'Жиноятлар сони',
                    //             data: [65, 59, 80, 81, 56, 55, 40],
                    //             backgroundColor: 'rgba(37, 99, 235, 0.2)',
                    //             borderColor: 'rgba(37, 99, 235, 1)',
                    //             borderWidth: 2,
                    //             tension: 0.4,
                    //             fill: true
                    //         }]
                    //     },
                    //     options: {
                    //         responsive: true,
                    //         plugins: {
                    //             legend: {
                    //                 display: false
                    //             }
                    //         },
                    //         scales: {
                    //             y: {
                    //                 beginAtZero: true
                    //             }
                    //         }
                    //     }
                    // });

                    // Personal Chart
                    const personalCtx = document.getElementById('personalChart').getContext('2d');
                    const personalChart = new Chart(personalCtx, {
                        type: 'doughnut',
                        data: {
                            labels: ['Профилактикадаги', 'Оилавий зўравонлик', 'Ижтимоий ишлардаги'],
                            datasets: [{
                                data: [892, 156, 200],
                                backgroundColor: [
                                    'rgba(37, 99, 235, 0.7)',
                                    'rgba(16, 185, 129, 0.7)',
                                    'rgba(59, 130, 246, 0.7)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: {
                                    position: 'right'
                                }
                            }
                        }
                    });
                // });

                // Initialize progress circles
                document.querySelectorAll('.circle').forEach(wrapper => {
                    const percent = parseFloat(wrapper.getAttribute('data-percent')) || 75;
                    const circle = wrapper.querySelector('.circle-bar');
                    const radius = circle.r.baseVal.value;
                    const circumference = 2 * Math.PI * radius;
                    const offset = circumference - (percent / 100) * circumference;

                    circle.style.strokeDasharray = circumference;
                    circle.style.strokeDashoffset = offset;
                });
            </script>
            <!-- Updated Map Script Section -->
        </main>
    </div>

    <footer>
        <div class="f-group d-flex column-gap-3 px-2">
            <a href="index.html">V1</a>
            <a href="index1.html">V2</a>
            <a href="index2.html">V3</a>
        </div>        
    </footer>
</body>
</html>